<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Rpc example</title>
    <script type="application/javascript" src="qrc:///simple-jsonrpc-js.js"></script>
    <script type="application/javascript" src="qrc:///qjsonchannel.js"></script>
    <script type="text/javascript" src="qrc:///qwebchannel.js"></script>
</head>

<body>
<h1 class="title"></h1>
<p class="paragraph"></p>
<script>
        new QWebChannel(qt.webChannelTransport, function(channel) {
            
            //configure
            var jrpc = new simple_jsonrpc();

            jrpc.toStream = function(_msg) {
                channel.objects.jsonRPC.invokeJsonRPC(_msg).then((response) => {
                    jrpc.messageHandler(response);
                });
            };


            new RpcWebChannel(jrpc, function(services) {
                services.object.testMethod().then(function (result) {
                    document.getElementsByClassName('paragraph')[0].innerHTML += 'object.testMethod result: ' + result + '<br>';
                });

                services.object.testMethodWithParams("one", false, 10).then(function (result) {
                    document.getElementsByClassName('paragraph')[0].innerHTML += 'object.testMethodWithParams result: ' + result + '<br>';
                });

                services.object.testMethodWithParamsAndReturnValue ("kostya").then(function (result) {
                    document.getElementsByClassName('paragraph')[0].innerHTML += 'object.testMethodWithParamsAndReturnValue result: ' + result + '<br>';
                });
            });
        });
</script>
</body>

</html>